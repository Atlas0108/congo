{% extends "base.html" %}

{% block title %}Login & Security - Congo{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-6">
    <!-- Breadcrumb -->
    <div class="mb-2">
        <a href="/account" class="text-blue-600 hover:underline text-sm">Your Account</a>
        <span class="text-gray-500 text-sm mx-1">></span>
        <span class="text-gray-700 text-sm">Login & Security</span>
    </div>
    
    <h1 class="text-2xl font-semibold mb-6">Login & Security</h1>
    
    <div class="bg-white border border-gray-200 rounded-lg p-6 space-y-6">
        <!-- Name Section -->
        <div class="flex items-start justify-between border-b border-gray-200 pb-6">
            <div class="flex-1">
                <h3 class="font-semibold text-gray-900 mb-1">Name</h3>
                <p id="user-name" class="text-gray-700">Loading...</p>
            </div>
            <button onclick="editField('name')" class="text-blue-600 hover:underline font-medium ml-4">
                Edit
            </button>
        </div>
        
        <!-- Email Section -->
        <div class="flex items-start justify-between border-b border-gray-200 pb-6">
            <div class="flex-1">
                <h3 class="font-semibold text-gray-900 mb-1">Email</h3>
                <p id="user-email" class="text-gray-700">Loading...</p>
            </div>
            <button onclick="editField('email')" class="text-blue-600 hover:underline font-medium ml-4">
                Edit
            </button>
        </div>
        
        <!-- Primary Mobile Number Section -->
        <div class="flex items-start justify-between border-b border-gray-200 pb-6">
            <div class="flex-1">
                <h3 class="font-semibold text-gray-900 mb-1">Primary mobile number</h3>
                <p id="user-phone" class="text-gray-700 mb-2">Loading...</p>
                <p class="text-sm text-gray-600">Quickly sign-in, easily recover passwords, and receive security notifications with this mobile number.</p>
            </div>
            <button onclick="editField('phone')" class="text-blue-600 hover:underline font-medium ml-4">
                Edit
            </button>
        </div>
        
        <!-- Passkey Section -->
        <div class="flex items-start justify-between border-b border-gray-200 pb-6">
            <div class="flex-1">
                <h3 class="font-semibold text-gray-900 mb-1">Passkey</h3>
                <p class="text-sm text-gray-600">Sign in the same way you unlock your device, by using face, fingerprint, or PIN.</p>
            </div>
            <button onclick="editField('passkey')" class="text-blue-600 hover:underline font-medium ml-4">
                Edit
            </button>
        </div>
        
        <!-- Password Section -->
        <div class="flex items-start justify-between border-b border-gray-200 pb-6">
            <div class="flex-1">
                <h3 class="font-semibold text-gray-900 mb-1">Password</h3>
                <p class="text-gray-700">**********</p>
            </div>
            <button onclick="editField('password')" class="text-blue-600 hover:underline font-medium ml-4">
                Edit
            </button>
        </div>
        
        <!-- 2-step verification Section -->
        <div class="flex items-start justify-between border-b border-gray-200 pb-6">
            <div class="flex-1">
                <h3 class="font-semibold text-gray-900 mb-1 flex items-center gap-2">
                    <svg class="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                    </svg>
                    2-step verification
                </h3>
                <p class="text-sm text-gray-600">Add a layer of security. Require a code in addition to your password.</p>
            </div>
            <button onclick="turnOn2Step()" class="text-blue-600 hover:underline font-medium ml-4">
                Turn on
            </button>
        </div>
        
        <!-- Compromised account Section -->
        <div class="flex items-start justify-between">
            <div class="flex-1">
                <h3 class="font-semibold text-gray-900 mb-1">Compromised account?</h3>
                <p class="text-sm text-gray-600">Take steps like changing your password and signing out everywhere.</p>
            </div>
            <button onclick="startAccountRecovery()" class="text-blue-600 hover:underline font-medium ml-4">
                Start
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Load user data
    function loadUserData() {
        fetch('/api/users/me')
            .then(response => {
                if (response.ok) {
                    return response.json();
                }
                throw new Error('Failed to load user data');
            })
            .then(user => {
                // Update name
                const nameEl = document.getElementById('user-name');
                if (nameEl) {
                    nameEl.textContent = user.name || user.username || 'Not set';
                }
                
                // Update email
                const emailEl = document.getElementById('user-email');
                if (emailEl) {
                    emailEl.textContent = user.email || 'Not set';
                }
                
                // Update phone
                const phoneEl = document.getElementById('user-phone');
                if (phoneEl) {
                    phoneEl.textContent = user.phone ? `+${user.phone}` : 'Not set';
                }
            })
            .catch(error => {
                console.error('Error loading user data:', error);
            });
    }
    
    function editField(field) {
        // TODO: Implement edit functionality
        alert(`Edit ${field} functionality coming soon!`);
    }
    
    function turnOn2Step() {
        // TODO: Implement 2-step verification
        alert('2-step verification setup coming soon!');
    }
    
    function startAccountRecovery() {
        // TODO: Implement account recovery
        alert('Account recovery process coming soon!');
    }
    
    window.editField = editField;
    window.turnOn2Step = turnOn2Step;
    window.startAccountRecovery = startAccountRecovery;
    
    loadUserData();
</script>
{% endblock %}

